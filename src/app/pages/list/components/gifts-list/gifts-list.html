<section class="mt-6">
  <div class="mb-3 flex items-center justify-between gap-3">
    <h2 class="text-lg font-semibold text-white">Cadeaux</h2>
    <button
      type="button"
      class="rounded-full border border-slate-600 px-3 py-1.5 text-sm font-medium text-slate-100 hover:bg-slate-700/60 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-400"
      (click)="toggleFillMode.emit()"
      [attr.aria-pressed]="fillMode() ? 'true' : null"
    >
      {{ fillMode() ? 'Quitter le mode remplissage' : 'Passer en mode remplissage' }}
    </button>
  </div>
  @if (fillMode()) {
    <p class="mb-2 text-sm text-slate-300">Mode remplissage actif : coche un cadeau pour indiquer qu’il est déjà acheté.</p>
  }
  <ul class="divide-y divide-slate-800 rounded-xl border border-slate-800 bg-slate-800/50">
    @for (g of gifts(); track g.id) {
      <li class="flex items-center justify-between gap-3 px-4 py-3">
        <div class="min-w-0">
          @if (g.url) {
            <a
              class="truncate font-medium text-blue-300 underline decoration-blue-400 decoration-2 underline-offset-4 hover:text-blue-200 hover:decoration-blue-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-400"
              [href]="g.url"
              target="_blank"
              rel="noopener noreferrer"
            >
              {{ g.title }}
            </a>
          } @else {
            <p class="truncate text-slate-100">{{ g.title }}</p>
          }
          @if (fillMode() && g.bought) {
            <p class="text-xs text-green-300">Déjà acheté</p>
          }
        </div>
        @if (fillMode()) {
          <div class="flex items-center gap-2">
            <input
              type="checkbox"
              class="size-4 rounded border-slate-600 bg-slate-900 text-blue-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-400"
              [checked]="!!g.bought"
              (change)="toggleBought.emit(g)"
              [disabled]="isUpdating()(g.id!)"
              [attr.aria-label]="'Marquer ' + g.title + ' comme acheté'"
            />
          </div>
        }
      </li>
    } @empty {
      <li class="px-4 py-5 text-slate-300">Aucun cadeau pour le moment.</li>
    }
  </ul>
</section>
